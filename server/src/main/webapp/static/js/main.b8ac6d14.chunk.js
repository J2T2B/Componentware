(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{35:function(e,t,a){},46:function(e,t,a){e.exports=a(69)},51:function(e,t,a){},69:function(e,t,a){"use strict";a.r(t);var n,s=a(1),r=a.n(s),i=a(24),o=a.n(i),c=(a(51),a(7)),l=a(8),h=a(10),u=a(9),d=a(6),m=a(11);!function(e){e[e.LOGIN=0]="LOGIN",e[e.GAME=1]="GAME",e[e.GAMEOVER=2]="GAMEOVER",e[e.CONNECTING=3]="CONNECTING"}(n||(n={}));var f=a(13),v=a.n(f),g=a(21);function p(e){return"object"===typeof e&&void 0!==e.onChatChange}function E(e){return"object"===typeof e&&void 0!==e.onChatChange&&void 0!==e.onMessage}var w=function(){function e(t){Object(c.a)(this,e),this.messages=void 0,this.partner=void 0,this.chatId=void 0,this.chatId=t.chatId,this.partner=t.partner,this.messages=[]}return Object(l.a)(e,[{key:"addMessage",value:function(e){this.messages=this.messages.sort((function(e,t){return e.created.unix()-t.created.unix()})),this.messages.push(e)}},{key:"getLastMessage",value:function(){return this.messages.length>0?this.messages[this.messages.length-1]:null}},{key:"unreadMessages",get:function(){var e=0;return this.messages.forEach((function(t){t.userHasRead||e++})),e}}]),e}(),b=a(17),y=a.n(b),k=function e(t){Object(c.a)(this,e),this.id=void 0,this.text=void 0,this.image=void 0,this.isAnswer=void 0,this.answers=void 0,this.userHasRead=void 0,this.created=void 0,this.id=t.id,this.text=t.text,this.image=t.image,this.isAnswer=t.isAnswer,this.answers=t.answers,this.userHasRead=t.userHasRead,this.created=y()(t.created).locale("de")};function C(e){var t=e;return void 0!==t.onError&&"function"===typeof t.onError}var O=function(){function e(){Object(c.a)(this,e),this.lastNotification=void 0,void 0!==Notification&&"granted"!==Notification.permission&&Notification.requestPermission()}return Object(l.a)(e,[{key:"sendNotification",value:function(e,t){this.isEnabled&&this.allowed&&new Notification(e,{body:t})}},{key:"isEnabled",get:function(){return void 0!==Notification&&"granted"===Notification.permission}},{key:"allowed",get:function(){return void 0===this.lastNotification?(this.lastNotification=y()(),!0):y.a.duration(y()().from(this.lastNotification)).asSeconds()>e.DURATION_BETWEEN_NOTIFICATIONS&&(this.lastNotification=y()(),!0)}}],[{key:"Instance",get:function(){return this.instance||(this.instance=new this)}}]),e}();O.DURATION_BETWEEN_NOTIFICATIONS=10,O.instance=void 0;var N=function(){function e(t){Object(c.a)(this,e),this.chatsListener=void 0,this.chatListener=void 0,this.chats=void 0,this._currentChat=void 0,this.errorHandlers=void 0,this.connectionListener=void 0,this.gameOverListeners=void 0,this.chatListener=[],this.chatsListener=[],this.chats=[],this.errorHandlers=[],this.gameOverListeners=[],this.connectionListener=t}return Object(l.a)(e,[{key:"sortChats",value:function(){this.chats=this.chats.sort((function(e,t){var a=Number.MAX_VALUE,n=Number.MAX_VALUE;return void 0!==e.getLastMessage()&&(a=e.getLastMessage().created.unix()),void 0!==t.getLastMessage()&&(n=t.getLastMessage().created.unix()),n-a}))}},{key:"initMessages",value:function(){this.sendMessage({command:"Reinit"})}},{key:"attach",value:function(e){E(e)?this.chatListener.push(e):p(e)?this.chatsListener.push(e):C(e)?this.errorHandlers.push(e):void 0!==e.onGameOver&&this.gameOverListeners.push(e)}},{key:"detatch",value:function(e){E(e)?this.chatListener=this.detatchListener(e,this.chatListener):p(e)?this.chatsListener=this.detatchListener(e,this.chatsListener):C(e)&&(this.errorHandlers=this.detatchListener(e,this.errorHandlers))}},{key:"submitAnswer",value:function(e,t,a){var n=e.id;this.sendMessage({command:"SubmitAnswer",answerId:n,chatId:t,messageId:a}),this.onMessage(t,{answers:[],created:y()(),id:a+"/"+n.toString(),isAnswer:!0,image:"",text:e.text,userHasRead:!0})}},{key:"readAllMessages",value:function(){var e=this;if(void 0===this._currentChat)throw new Error("No current Chat.");var t=this._currentChat.messages.filter((function(e){return!e.userHasRead})),a=!0,n=!1,s=void 0;try{for(var r,i=t[Symbol.iterator]();!(a=(r=i.next()).done);a=!0){var o=r.value;o.userHasRead=!0,this.sendMessage({command:"ReadMessage",messageId:o.id,chatId:this._currentChat.chatId})}}catch(c){n=!0,s=c}finally{try{a||null==i.return||i.return()}finally{if(n)throw s}}this.chatsListener.forEach((function(t){return t.onChatChange(e.chats)}))}},{key:"detatchListener",value:function(e,t){return t.filter((function(t){return t!==e}))}},{key:"onMessage",value:function(e,t){var a=this,n=new k(t),s=this.chats.find((function(t){return t.chatId===e}));if(void 0===s)throw new Error("Chat ".concat(e," not found. Fatal Error"));if(s.addMessage(n),!t.userHasRead){O.Instance.sendNotification(s.partner.name,t.text);var r=new Audio("eventually.mp3");r.play().then((function(){return r.remove()}))}this.sortChats(),void 0!==this._currentChat&&e===this._currentChat.chatId&&(this.chatListener.forEach((function(e){return e.onMessage(a._currentChat,n)})),this.readAllMessages()),this.chatsListener.forEach((function(e){return e.onChatChange(a.chats)}))}},{key:"onAnswer",value:function(e,t,a){var n=this,s=this.chats.find((function(t){return t.chatId===e}));if(void 0===s)throw new Error("Chat ".concat(e," not found. Fatal Error"));var r=s.messages.find((function(e){return e.id===t}));if(void 0===r)throw new Error("Message ".concat(t," on Chat ").concat(e," not found. Fatal Error"));r.answers.push(a),void 0!==this._currentChat&&this._currentChat.chatId===e&&this.chatListener.forEach((function(e){return e.onMessage(n._currentChat,r)}))}},{key:"onSocketMessage",value:function(e){var t=this;switch(e.command){case"CreateChat":if(this.chats.push(new w(e.chat)),void 0!==e.chat.messages&&e.chat.messages.length>0){var a=!0,n=!1,s=void 0;try{for(var r,i=e.chat.messages[Symbol.iterator]();!(a=(r=i.next()).done);a=!0){var o=r.value;this.onMessage(e.chat.chatId,o)}}catch(c){n=!0,s=c}finally{try{a||null==i.return||i.return()}finally{if(n)throw s}}}this.sortChats(),this.chatsListener.forEach((function(e){return e.onChatChange(t.chats)}));break;case"AddMessage":this.onMessage(e.chatId,e.message);break;case"AddAnswer":this.onAnswer(e.chatId,e.messageId,e.answer);break;case"ChangePoints":this.chatsListener.forEach((function(t){return t.onPointsChange(e.points)}));break;case"HandleError":this.errorHandlers.forEach((function(t){return t.onError(e.message)}));break;case"WebSocketCreated":console.log("WebSocket erzeugt. Juhu");break;case"GameOver":console.log("GameOver...."),this.gameOverListeners.forEach((function(e){return e.onGameOver()}));break;default:throw new Error("The Command ".concat(e.command," is unknown"))}}},{key:"currentChat",get:function(){return this._currentChat},set:function(e){var t=this;this._currentChat=e,void 0!==e&&(this.readAllMessages(),this.chatListener.forEach((function(e){return e.onChatChange(t._currentChat)}))),this.chatsListener.forEach((function(e){return e.onCurrentChatChange(t._currentChat)}))}}]),e}(),M=function(e){function t(e,a,n){var s;return Object(c.a)(this,t),(s=Object(h.a)(this,Object(u.a)(t).call(this,e))).baseUrl=void 0,s.token=void 0,s.wsConnection=void 0,s.retrys=0,s.baseUrl=a,s.token=n,s}return Object(m.a)(t,e),Object(l.a)(t,[{key:"connect",value:function(){var e=this;this.retrys++;var t=new URL("".concat(this.baseUrl,"/game/").concat(this.token));t.protocol="ws:";var a=this.onCloseOrError.bind(this);return new Promise((function(n){e.wsConnection=new WebSocket(t.toString()),e.wsConnection.onclose=a,e.wsConnection.onerror=a,e.wsConnection.onmessage=e.onWebSocketMessage.bind(e),e.wsConnection.onopen=function(){console.log("Websocket verbunden!"),n(!0),e.connectionListener.onConnect(e),e.retrys=0}}))}},{key:"sendMessage",value:function(e){var t=this;void 0===this.wsConnection||1!==this.wsConnection.readyState?window.setTimeout((function(){return t.sendMessage(e)}),1e3):this.wsConnection.send(JSON.stringify(e))}},{key:"onCloseOrError",value:function(){this.retrys<5?(this.connectionListener.onDisconnect(),console.log("Websocket getrennt. Versuche erneute Verbindung..."),window.setTimeout(this.connect.bind(this),0)):this.connectionListener.onReset()}},{key:"onWebSocketMessage",value:function(e){var t=e.data,a=JSON.parse(t);this.onSocketMessage(a)}}]),t}(N),S=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).intervalId=void 0,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"connect",value:function(){var e=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.simulateMessage=this.simulateMessage.bind(this),console.log("Globale Funktion simulateMessage(...) hinzugef\xfcgt"),window.setTimeout(this.quereMessage.bind(this),2e3),this.connectionListener.onConnect(this),e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendMessage",value:function(e){console.log("Nachricht an Server",e)}},{key:"simulateMessage",value:function(e){var t=this;Array.isArray(e)?e.forEach((function(e){return t.onSocketMessage(e)})):this.onSocketMessage(e)}},{key:"quereMessage",value:function(){for(var e=0;e<5;e++){this.simulateMessage({command:"CreateChat",chat:{chatId:e.toString(),partner:{name:"Kunde "+(e+1),imageUrl:"http://emilcarlsson.se/assets/harveyspecter.png"},messages:[]}});for(var t=0;t<10;t++){var a=Math.random()<.5,n=[];if(!a)for(var s=4*Math.random()+1,r=0;r<s;r++)n.push({id:10*t+r,text:"Antwort "+t+r});this.simulateMessage({command:"AddMessage",chatId:e.toString(),message:{id:(10*e+t).toString(),text:"Hallo Will "+(10*e+t).toString(),image:"",answers:n,userHasRead:!1,created:(new Date).getTime()-99999999,isAnswer:a}})}}this.intervalId=window.setInterval(this.upgradePoints.bind(this),5e3)}},{key:"upgradePoints",value:function(){var e=function(){return Math.round(100*Math.random())};this.simulateMessage({command:"ChangePoints",points:{budget:e(),chefSatisfaction:e(),customerExperience:e()}})}}]),t}(N),j=function(){function e(t,a){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(c.a)(this,e),this.listener=void 0,this.baseUrl=void 0,this.isTestMode=void 0,this.listener=a,this.baseUrl=t,this.isTestMode=n}return Object(l.a)(e,[{key:"connectToWebSocket",value:function(){var e=Object(g.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.isTestMode?new S(this.listener):new M(this.listener,this.baseUrl,t),e.next=3,a.connect();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(g.a)(v.a.mark((function e(t,a){var n,s,r,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.baseUrl+"/api/login",s={username:t,password:a},e.next=4,fetch(n,{body:JSON.stringify(s),method:"PUT",headers:{"Content-Type":"application/json"}});case 4:return r=e.sent,e.next=7,r.text();case 7:if(i=e.sent,200!==r.status){e.next=13;break}return e.next=11,this.connectToWebSocket(i);case 11:e.next=23;break;case 13:if(401!==r.status){e.next=17;break}throw new Error("Password is incorrect.");case 17:if(500!==r.status){e.next=21;break}throw new Error("User not found.");case 21:throw console.log(r),new Error(i);case 23:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(g.a)(v.a.mark((function e(t,a){var n,s,r,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.baseUrl+"/api/register",s={username:t,password:a},e.next=4,fetch(n,{body:JSON.stringify(s),method:"POST",headers:{"Content-Type":"application/json"}});case 4:return r=e.sent,e.next=7,r.text();case 7:if(i=e.sent,200!==r.status&&204!==r.status){e.next=13;break}return e.next=11,this.login(t,a);case 11:e.next=15;break;case 13:throw console.log(i),new Error(i);case 15:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()}]),e}(),L=a(83),A=a(77),I=(a(35),a(70)),x=a(71),H=a(72),T=a(73),W=a(74),P=a(75),U=a(76),B=a(78),R=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(h.a)(this,Object(u.a)(t).call(this,e))).state={width:window.innerWidth},a.onSizeChange=a.onSizeChange.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.onSizeChange(),document.getElementsByTagName("body")[0].classList.add("login-register-background"),window.addEventListener("resize",this.onSizeChange)}},{key:"componentWillUnmount",value:function(){document.getElementsByTagName("body")[0].classList.remove("login-register-background"),window.removeEventListener("resize",this.onSizeChange)}},{key:"onSizeChange",value:function(){this.setState({width:window.innerWidth})}},{key:"render",value:function(){return r.a.createElement(I.a,null,r.a.createElement(x.a,{className:"transparent text-center"},r.a.createElement("h2",{className:"display-4 headline-font"},"Life-Work-Balance von William Walker")),r.a.createElement(H.a,{className:(this.state.width>992?"mx-auto w-50":"mx-auto")+" transparent"},r.a.createElement(T.a,null,r.a.createElement(W.a,null,r.a.createElement("h4",{className:""},"login"===this.props.mode&&"Anmelden","register"===this.props.mode&&"Registrieren"))),r.a.createElement(P.a,null,r.a.createElement(U.a,null,r.a.createElement(A.a,{color:"primary",active:"login"===this.props.mode,href:"#/login",tag:"a"},"Anmelden"),r.a.createElement(A.a,{color:"primary",active:"register"===this.props.mode,href:"#/register",tag:"a"},"Registrieren")),r.a.createElement(B.a,null,this.props.children))))}}]),t}(r.a.Component),G=a(79),D=a(80),_=a(81),V=a(82);function F(e){return r.a.createElement(G.a,null,r.a.createElement(D.a,null,e.label),r.a.createElement(_.a,{type:e.type,placeholder:e.placeholder,value:e.value,name:e.name,onChange:(t=e.onValue,function(e){var a=e.target,n={};n[a.name]=a.value,t(n)}),onKeyPress:e.onKeyPress,invalid:void 0!==e.error,autoComplete:e.autoComplete}),void 0!==e.error&&r.a.createElement(V.a,null,e.error));var t}function z(e){void 0===e?e="LWB William Walker":e+=" | LWB William Walker",document.querySelector("title").innerText=e}var K=a(19),J=a(23);function q(e){return function(t){"Enter"===t.key&&e()}}var X=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(h.a)(this,Object(u.a)(t).call(this,e))).state={busy:!1,username:"",password:""},a.onInput=a.onInput.bind(Object(d.a)(a)),a.onSubmit=a.onSubmit.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"onInput",value:function(e){this.setState(e)}},{key:"componentDidMount",value:function(){z("Login")}},{key:"onSubmit",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t,a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({busy:!0,error:void 0}),t=this.state,a=t.username,n=t.password,e.prev=2,e.next=5,this.props.connector.login(a,n);case 5:window.location.href="#/",e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),this.setState({busy:!1,error:e.t0.message});case 11:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(R,{mode:"login"},this.state.error&&r.a.createElement(L.a,{color:"danger"},this.state.error),r.a.createElement(F,{label:"Username",onValue:this.onInput,name:"username",placeholder:"william.walker1",value:this.state.username,type:"text",autoComplete:"username"}),r.a.createElement(F,{label:"Passwort",onValue:this.onInput,name:"password",placeholder:"132456789",value:this.state.password,type:"password",autoComplete:"current-password",onKeyPress:q(this.onSubmit)}),r.a.createElement(A.a,{onClick:this.onSubmit,color:"success",disabled:0===this.state.username.length||0===this.state.password.length},this.state.busy&&r.a.createElement(K.a,{icon:J.b,spin:!0}),"Anmelden"))}}]),t}(r.a.Component),Z={usernameToShort:"Nutzername darf nicht leer sein",passwordToShort:"Passwort darf nicht leer sein",passwordMatch:"Passw\xf6rter stimmen nicht \xfcberein"},$=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(h.a)(this,Object(u.a)(t).call(this,e))).state={busy:!1,name:"William Walker",username:"",usernameError:Z.usernameToShort,password:"",passwordError:Z.passwordToShort,repeatPassword:""},a.onInput=a.onInput.bind(Object(d.a)(a)),a.onSubmit=a.onSubmit.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){z("Registrieren")}},{key:"onInput",value:function(e){e.repeatPasswordError=void 0,e.passwordError=void 0,e.usernameError=void 0,(void 0!==e.password&&e.password!==this.state.repeatPassword||void 0!==e.repeatPassword&&e.repeatPassword!==this.state.password)&&(e.repeatPasswordError=Z.passwordMatch),void 0!==e.password&&e.password.length<1&&(e.passwordError=Z.passwordToShort),void 0!==e.username&&e.username.length<1&&(e.usernameError=Z.usernameToShort),this.setState(e)}},{key:"onSubmit",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t,a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({busy:!0,error:void 0}),t=this.state,a=t.username,n=t.password,e.prev=2,e.next=5,this.props.connector.register(a,n);case 5:window.location.href="#/",e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),this.setState({busy:!1,error:e.t0.message});case 11:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(R,{mode:"register"},this.state.error&&r.a.createElement(L.a,{color:"danger"},this.state.error),r.a.createElement(G.a,null,r.a.createElement(D.a,null,"Name"),r.a.createElement(_.a,{type:"text",value:this.state.name,autoComplete:"off",readOnly:!0})),r.a.createElement(F,{label:"Username",name:"username",placeholder:"william.walker",value:this.state.username,type:"text",onValue:this.onInput,error:this.state.usernameError,autoComplete:"username"}),r.a.createElement(F,{onValue:this.onInput,label:"Passwort",name:"password",placeholder:"12345678",value:this.state.password,type:"password",error:this.state.passwordError,autoComplete:"new-password"}),r.a.createElement(F,{onValue:this.onInput,label:"Passwort wiederholen",name:"repeatPassword",placeholder:"12345678",value:this.state.repeatPassword,type:"password",error:this.state.repeatPasswordError,autoComplete:"new-password",onKeyPress:q(this.onSubmit)}),r.a.createElement(A.a,{color:"success",onClick:this.onSubmit,disabled:!Q(this.state.repeatPasswordError,this.state.passwordError,this.state.usernameError)},this.state.busy&&r.a.createElement(K.a,{icon:J.b,spin:!0}),"Registrieren"))}}]),t}(r.a.Component);function Q(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];for(var n=0,s=t;n<s.length;n++){if(void 0!==s[n])return!1}return!0}var Y=a(14),ee=a(89),te=a(84),ae=a(85),ne=a(86),se=a(87),re=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(h.a)(this,Object(u.a)(t).call(this,e))).interval=0,a.state={lastMessageDifference:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.interval=window.setInterval(this.setDifference.bind(this),6e4)}},{key:"componentDidUpdate",value:function(e,t){t.messageId!==this.props.chat.getLastMessage().id&&this.setDifference()}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.interval)}},{key:"setCurrentChat",value:function(){this.props.chatsHandler.currentChat=this.props.chat}},{key:"setDifference",value:function(){var e=this.props.chat.getLastMessage();e&&this.setState({lastMessageDifference:e.created.fromNow(),messageId:e.id})}},{key:"render",value:function(){var e=this.props.chat.getLastMessage(),t=null===e?"Keine Nachricht":e.text,a=this.props.chat.unreadMessages,n=r.a.createElement(r.a.Fragment,null);return t.length>23&&(t=t.substr(0,23)+"..."),a>0&&(n=r.a.createElement(te.a,{color:"primary",pill:!0},a),t=r.a.createElement("strong",null,t)),r.a.createElement(ae.a,{onClick:this.setCurrentChat.bind(this),active:this.props.chatsHandler.currentChat===this.props.chat},r.a.createElement("div",{className:"d-flex w-100 justify-content-between"},r.a.createElement(ne.a,null,this.props.chat.partner.name),r.a.createElement("small",null,this.state.lastMessageDifference)),r.a.createElement(se.a,{className:"d-flex w-100 justify-content-between"},t,n))}}]),t}(r.a.Component),ie=a(88);function oe(e){var t=e.label,a=e.score,n="primary";return a<=5?n="danger":a<=15?n="warning":a>=70?n="success":a>=50&&(n="info"),r.a.createElement("div",null,t,r.a.createElement(ie.a,{color:n,value:a},a))}var ce=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(h.a)(this,Object(u.a)(t).call(this,e))).state={chats:[],currentChat:void 0,currentPoints:{chefSatisfaction:0,customerExperience:0,budget:0}},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"onPointsChange",value:function(e){this.setState({currentPoints:e})}},{key:"onCurrentChatChange",value:function(e){this.setState({currentChat:e})}},{key:"onChatChange",value:function(e){this.setState({chats:e})}},{key:"componentDidMount",value:function(){z("Chats von William Walker"),this.props.chatsHandler.attach(this),this.props.chatsHandler.initMessages()}},{key:"componentWillUnmount",value:function(){this.props.chatsHandler.detatch(this)}},{key:"render",value:function(){var e=this;if(!this.props.isOpen)return r.a.createElement(r.a.Fragment,null);var t=this.state,a=t.chats,n=t.currentPoints;return r.a.createElement(I.a,null,r.a.createElement(H.a,{color:"secondary"},r.a.createElement(P.a,null,r.a.createElement("div",{className:"contact-profile"},r.a.createElement("img",{className:"contact-picture",src:"http://emilcarlsson.se/assets/harveyspecter.png",alt:"William Walker"}),r.a.createElement("div",{className:"contact-name"},"William Walker")),r.a.createElement("div",{className:"progressbars"},r.a.createElement(oe,{label:"Kundenerfahrung",score:n.customerExperience}),r.a.createElement(oe,{label:"Chefzufriedenheit",score:n.chefSatisfaction}),r.a.createElement(oe,{label:"Firmenbudget",score:n.budget})))),r.a.createElement(ee.a,{className:"chat-list"},a.map((function(t){return r.a.createElement(re,{chat:t,key:t.chatId,chatsHandler:e.props.chatsHandler})}))))}}]),t}(r.a.Component),le=a(97),he=a(98),ue=a(31),de=function(e){var t,a=e.m,n=e.chatId;return r.a.createElement("div",{className:"row",key:n+"/"+a.id},r.a.createElement("div",{className:"message"},r.a.createElement("div",{className:"bubble"+(a.isAnswer?" reply":" receive")},r.a.createElement("div",{className:"content"},r.a.createElement("p",{dangerouslySetInnerHTML:(t=a.text,{__html:t.replace("\n","<br />")})}),r.a.createElement("p",{className:"time"},a.created.isBefore(y()().startOf("day"))&&a.created.format("L"),"\xa0",a.created.format("HH:mm"))))))},me=a(99),fe=a(90),ve=a(91),ge=a(92),pe=function(e){return r.a.createElement("div",{className:"row"},r.a.createElement(me.a,{isOpen:e.isOpen,toggle:e.toggle},r.a.createElement(fe.a,{toggle:e.toggle},"Ihre Antwortm\xf6glichkeiten"),r.a.createElement(ve.a,null,r.a.createElement(ee.a,null,e.lastMessage.answers.map((function(t){return r.a.createElement(ae.a,{tag:"button",className:e.choosenAnswer===t?"active":"",onClick:function(){return e.onAnswerChoose(t)},id:"answer-"+t.id,key:t.id},t.text)})))),r.a.createElement(ge.a,null,r.a.createElement(A.a,{color:"secondary",onClick:e.toggle},"Abbrechen"))))},Ee=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(h.a)(this,Object(u.a)(t).call(this,e))).messagesEnd=void 0,a.state={chat:void 0,openAnswers:!1},a.openAnswers=a.openAnswers.bind(Object(d.a)(a)),a.onAnswerChoose=a.onAnswerChoose.bind(Object(d.a)(a)),a.onSendMessage=a.onSendMessage.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"onChatChange",value:function(e){this.setState({chat:e,chosenAnswer:void 0})}},{key:"onMessage",value:function(e,t){this.setState({chat:e,chosenAnswer:void 0})}},{key:"scrollToBottom",value:function(){this.messagesEnd.scrollIntoView({behavior:"smooth"})}},{key:"componentDidMount",value:function(){this.props.chatsHandler.attach(this),this.scrollToBottom()}},{key:"componentWillUnmount",value:function(){this.props.chatsHandler.detatch(this),this.scrollToBottom()}},{key:"openAnswers",value:function(){var e=this.state.chat.getLastMessage().answers[0];if(this.setState((function(e){return{openAnswers:!e.openAnswers}})),void 0===this.state.chosenAnswer){var t=void 0===e?void 0:e;this.setState({chosenAnswer:t})}}},{key:"onAnswerChoose",value:function(e){this.setState({chosenAnswer:e,openAnswers:!1})}},{key:"toggleModal",value:function(){this.setState({openAnswers:!this.openAnswers})}},{key:"onSendMessage",value:function(){if(void 0!==this.state.chosenAnswer){var e=this.state.chosenAnswer;this.props.chatsHandler.submitAnswer(e,this.state.chat.chatId,this.state.chat.getLastMessage().id)}}},{key:"render",value:function(){var e=this;if(void 0===this.state.chat)return r.a.createElement(I.a,null,r.a.createElement("div",{className:"contact-profile"},r.a.createElement("img",{className:"contact-picture",alt:""}),r.a.createElement("div",{className:"contact-name"},r.a.createElement("em",null,"Kein Chat ausgew\xe4hlt"))),r.a.createElement("div",{className:"messages col-md-12"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"message"},r.a.createElement("em",null,"Keine Nachrichten"))),r.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(t){e.messagesEnd=t}})));var t=this.state.chat;return r.a.createElement(I.a,null,r.a.createElement("div",{className:"contact-profile"},r.a.createElement("img",{className:"contact-picture",src:""!=this.state.chat.partner.imageUrl?this.state.chat.partner.imageUrl:"./default.jpg",alt:""}),r.a.createElement("div",{className:"contact-name"},this.state.chat.partner.name)),r.a.createElement("div",{className:"messages col-md-12"},t.messages.map((function(e){return r.a.createElement(de,{m:e,chatId:t.chatId,key:t.chatId+"/"+e.id})})),r.a.createElement("div",{style:{float:"left",clear:"both",margin:"10px"},ref:function(t){e.messagesEnd=t}}),this.state.chat.getLastMessage()&&this.state.chat.getLastMessage().answers.length>0&&r.a.createElement(pe,{choosenAnswer:this.state.chosenAnswer,isOpen:this.state.openAnswers,lastMessage:this.state.chat.getLastMessage(),onAnswerChoose:this.onAnswerChoose.bind(this),toggle:this.toggleModal.bind(this)})),r.a.createElement("div",{className:"message-input"},r.a.createElement("div",{className:"row text-center"},r.a.createElement("div",{className:"col-md-1"},r.a.createElement(A.a,{color:"primary",onClick:function(){return console.log("I am useless. :^)")}},r.a.createElement(K.a,{icon:ue.b}))),r.a.createElement("div",{className:"col-md-10"},r.a.createElement("div",{className:"form-control",onClick:this.openAnswers},this.state.chat.getLastMessage().isAnswer?"":this.state.chosenAnswer?this.state.chosenAnswer.text:r.a.createElement("i",null,"Bitte Antwort w\xe4hlen"))),r.a.createElement("div",{className:"col-md-1"},r.a.createElement(A.a,{color:"primary",onClick:this.onSendMessage},r.a.createElement(K.a,{icon:ue.a}))))))}}]),t}(r.a.Component),we=a(93),be=a(94),ye=a(95),ke=a(96);function Ce(e){var t=e.toggleChatsList;return r.a.createElement(we.a,{color:"faded",dark:!0,className:"mb-3"},r.a.createElement(be.a,{href:"#",className:"mr-auto"},"Life-Work-Balance von William Walker"),r.a.createElement(ye.a,null,r.a.createElement(ke.a,{className:"d-md-none"},r.a.createElement(A.a,{color:"primary",onClick:t},"Chatliste"))))}var Oe=a(44),Ne=function(){return r.a.createElement(x.a,null,r.a.createElement("h1",null,r.a.createElement(K.a,{icon:J.a}),"Error 404"),r.a.createElement("p",{className:"lead"},"Die Seite gibt es nicht"),r.a.createElement("p",{className:"lead"},r.a.createElement("a",{href:"#/",color:"primary"},"Zur Startseite")))},Me=function(){return r.a.createElement(x.a,null,r.a.createElement("h1",null,r.a.createElement(K.a,{icon:J.b,spin:!0}),"Die Verbindung wurde unterbrochen."),r.a.createElement("p",{className:"lead"},"Bitte warten Sie bis die Verbindung wiederhergestellt wurde....."))};function Se(){return Object(s.useEffect)((function(){return document.getElementsByTagName("body")[0].classList.add("gameover-background"),function(){return document.getElementsByTagName("body")[0].classList.remove("gameover-background")}})),r.a.createElement(I.a,null,r.a.createElement(x.a,{className:"transparent"},r.a.createElement("h1",{className:"display-3"},"GameOver ",r.a.createElement("span",{role:"img"},"\u2620")),"Du wurdest entlassen. ",r.a.createElement("br",null),"Dein Konto wurde gel\xf6scht. Du musst ein neues erstellen um wieder zu spielen",r.a.createElement("p",{className:"lead"},r.a.createElement(A.a,{color:"primary",onClick:function(){return window.location.reload()}},"Neues Leben beginnen"))))}var je=a(45),Le=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(h.a)(this,Object(u.a)(t).call(this,e))).state={errors:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.chatsHandler.attach(this)}},{key:"componentWillUnmount",value:function(){this.props.chatsHandler.detatch(this)}},{key:"onError",value:function(e){this.setState((function(t){return{errors:[].concat(Object(je.a)(t.errors),[e])}}))}},{key:"onClose",value:function(){this.setState({errors:[]})}},{key:"render",value:function(){return s.createElement(me.a,{isOpen:this.state.errors.length>0},s.createElement(fe.a,null,"Es sind Fehler aufgetreten"),s.createElement(ve.a,null,"Folgende Fehler sind aufgetreten: ",s.createElement("br",null),this.state.errors.map((function(e){return s.createElement(L.a,{color:"danger",key:e},e)}))),s.createElement(ge.a,null,s.createElement(A.a,{color:"primary",onClick:this.onClose.bind(this)},"Ok")))}}]),t}(s.Component),Ae="",Ie=new URL(window.location.toString());Ie.hash="",Ae=(Ae=Ie.toString()).substring(0,Ae.length-1);var xe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(h.a)(this,Object(u.a)(t).call(this,e))).state={isChatListOpen:!0,connector:new j(Ae,Object(d.a)(a),!1),mode:n.LOGIN},a.renderLoginBody=a.renderLoginBody.bind(Object(d.a)(a)),a.renderNormalBody=a.renderNormalBody.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"onConnect",value:function(e){this.setState({chatsHandler:e,mode:n.GAME}),e.attach(this),window.currentChatsHandler=e}},{key:"onDisconnect",value:function(){this.state.mode!==n.GAMEOVER&&this.setState({chatsHandler:void 0,mode:n.CONNECTING})}},{key:"toggleChatsList",value:function(){this.setState((function(e){return{isChatListOpen:!e.isChatListOpen}}))}},{key:"onReset",value:function(){this.setState({mode:n.LOGIN})}},{key:"renderLoginBody",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.b,{path:"/login",exact:!0,render:function(){return r.a.createElement(X,{connector:e.state.connector})}}),r.a.createElement(Y.b,{path:"/register",exact:!0,render:function(){return r.a.createElement($,{connector:e.state.connector})}}),r.a.createElement(Y.a,{from:"*",to:"/login"}))}},{key:"renderNormalBody",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.b,{path:"/",exact:!0},r.a.createElement(le.a,null,r.a.createElement(he.a,{md:4},r.a.createElement(ce,{chatsHandler:this.state.chatsHandler,isOpen:this.state.isChatListOpen})),r.a.createElement(he.a,{md:8},r.a.createElement(Ee,{chatsHandler:this.state.chatsHandler})))),r.a.createElement(Le,{chatsHandler:this.state.chatsHandler}))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ce,{toggleChatsList:this.toggleChatsList.bind(this)}),r.a.createElement(I.a,{fluid:!0},r.a.createElement(Oe.a,null,r.a.createElement(Y.d,null,this.state.mode===n.LOGIN&&r.a.createElement(this.renderLoginBody,null),this.state.mode===n.GAME&&r.a.createElement(this.renderNormalBody,null),this.state.mode===n.GAMEOVER&&r.a.createElement(Se,null),this.state.mode===n.CONNECTING&&r.a.createElement(Me,null),r.a.createElement(Y.b,{path:"/404",exact:!0,component:function(){return r.a.createElement(Ne,null)}}),r.a.createElement(Y.a,{from:"*",to:"/404"})))))}},{key:"onGameOver",value:function(){this.setState({mode:n.GAMEOVER})}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(68);o.a.render(r.a.createElement(xe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[46,1,2]]]);
//# sourceMappingURL=main.b8ac6d14.chunk.js.map